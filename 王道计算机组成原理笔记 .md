# 24考研王道计算机组成原理笔记
@[TOC](文章目录)

# 前言
该文章笔记来源于2023王道计算机组成原理网课。删除了部分大纲之外的内容，并做了一些补充。主要是为了自己考研复习使用。也方便大家参考学习！

[24考研深入浅出计算机网络笔记](http://t.csdn.cn/cYhQM)

# 一、计算机系统概述
 
## 1.1 计算机的发展
![](https://img-blog.csdnimg.cn/082e0499c9d54b95b5a53c2df3627254.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/3a0627ae4e974e76b07b2af21e27aaad.png)
数据库管理系统--系统软件
数据库系统--应用软件
## 1.2 计算机硬件

### 1.2.1 计算机硬件的基本组成
**早期的冯诺依曼机**

“存储程序”的概念是指将指令以二进制代码的形式事先输入计算机的主存储器，然后按其在存储器中的首地址执行程序的第一条指令，以后就按该程序的规定顺序执行其他指令，直到程序执行结束。 ![在这里插入图片描述](https://img-blog.csdnimg.cn/737b835de6c740799fc95d0ab5b3427b.png)

冯诺依曼计算机的特点

 - 计算机由五大部件组成
 - 指令和数据以同等地位存于存储器，可按地址访问（统一编址，指令和数据所在存储单元无差异）
 - 指令和数据用二进制表示
 - 指令由操作码和地址码组成
 - 存储程序
 - 以运算器为中心（输入输出设备与存储器之间的数据传送通过运算器完成）

数据驱动方式：

 - 控制流驱动：指令-->数据
 - 数据流驱动：数据-->指令

现代计算机的结构
![在这里插入图片描述](https://img-blog.csdnimg.cn/f35186ff66f74a33a61e2791594d754c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/cd16e7a27ec14c6aaa2bb31813eda7d7.png)
**知识点回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/754e1e8eaf6f498eab76b668623da91c.png)
### 1.2.2 各个硬件的工作原理
**主存储器的基本组成**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fcb19b46cf24480b9197a91077128fb3.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/6a1427020c3f45ac984407ed9edc7b89.png)
**运算器的基本组成**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7a5119cccff24e978b226398a35efae4.png)
**控制器的基本组成**
![在这里插入图片描述](https://img-blog.csdnimg.cn/81de66e961a54f57b1a802ac5ecaaa62.png)
**计算机的工作过程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/ebb1fdbe26dc4307ba0e3ab48fa21b0b.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/075865d7ea4e470686123bb850c8f61c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9596daf05df9495e95aa67a45b179c8f.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/158703ac47e04769a5e0fd45802ed06c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/58924217628540bd81619c6d8dbbc67c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/0cacc1f2ef844f5d92f69f01629d68f5.png)
总结：
![在这里插入图片描述](https://img-blog.csdnimg.cn/485a0ea23592450ea1e66ec6ff6145e7.png)
**知识点回顾**

![在这里插入图片描述](https://img-blog.csdnimg.cn/7409287d9f254f2f898b1e8c2fb370f1.png)
注：现在的计算机通常把MAR,MDR也集成在CPU内

### 1.2.3 计算机系统的层次结构
![在这里插入图片描述](https://img-blog.csdnimg.cn/a7ba193337d641a2a9902f3b4ec01102.png)

汇编语言指令和机器语言指令一一对应
 LOAD： 取数操作 ，MUL： 乘法操作

![在这里插入图片描述](https://img-blog.csdnimg.cn/9edaea324a944f4cb2b64e6c0384fbe8.png)

**编译程序**：将高级语言编写的源程序全部语句一次全部翻译成机器语言程序，而后在执行机器语言程序（只需翻译一次）。 例如：使用我们使用C语言写的程序，经过编译和汇编之后，最终形成.exe文件，该.exe文件是用机器语言描述的程序，每次运行这个程序，只需加载.exe文件。
 **解释程序**：将源程序的一条语句翻译成对应于机器语言的语句，并立即执行。紧接着在翻译下一句（每一次都要翻译）。  编译型语言执行效率较解释型语言高。  注：编译、汇编、解释程序，可统称为“翻译程序”。

计算机体系结构：机器语言程序员所见到的计算机系统的属性概念性的结构与功能特性（指令系统、数据类型、寻址技术、I/O机理）

 - 如何设计硬件与软件之间的接口。

计算机组成原理：实现计算机体系结构所体现的属性，对程序员“透明”（具体指令的实现）

 - 如何用硬件实现所定义的接口。

“透明”：看不见
“公开透明”：看得见

![在这里插入图片描述](https://img-blog.csdnimg.cn/e6b64018450143cd99ab1bb07871be35.jpeg)


**知识点回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/028292b6a0eb4ca781d53dd69b6dd695.png)
## 1.3 计算机性能指标

 1. 机器字长：能够直接处理的二进制数据的位数
 2. 指令字长：一个指令中包含的二进制代码的位数
 3. 存储字长：一个存储单元二进制数据的位数

### 1.3.1 存储器性能指标

 - MAR位数反应存储单元的个数（最后支持多少个）
 - MDR位数=存储字长=每个存储单元的大小
 
总容量=存储单元个数×存储字长 bit =存储单元个数×存储字长/8 Byte
Eg:MAR为32位，MDR为8位
总容量=2^32×8 bit=4GB

n个2进制位能表示多少种不同的状态
![在这里插入图片描述](https://img-blog.csdnimg.cn/53c286e067f54c5b86566edb08090cda.png)
2^10:K
2^20:M
2^30:G
2^40:T
### 1.3.2 CPU性能指标
![在这里插入图片描述](https://img-blog.csdnimg.cn/8b6321e0cdec4a22813ba9a301089cd2.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20a3ecfd7b224326af3e5ee57c31386b.png)
**注**：公式中主频的值反映的是：每秒钟会出现多少个时钟周期。

![在这里插入图片描述](https://img-blog.csdnimg.cn/17af097b22364954bb4482cd683a3ba4.png)
**注**：注意与存储器的容量或者文件的大小中的K、M、G、T的区别
### 1.3.3 系统整体的性能指标

 - 数据通路带宽：数据总线一次所能并行传送信息的位数（各硬件部件通过数据总线传输数据）
 - 吞吐量：指系统在单位时间内处理请求的数量。他取决于信息能多快地输入内存，CPU能多快地取指令，数据能多快地从内存取出或存入，以及所得结果能多快地从内存送给一台外部设备。这些步骤中的每一步都关系到主存，因此，系统吞吐量主要取决于主存的存取周期。
 - 响应时间：指从用户向计算发送一个请求，到系统对该请求做出响应并获得它所需要的结果的等待时间。通常包括CPU时间（运行一个程序所花费的时间）与等待时间（用于磁盘访问、存储器访问、I/O操作、操作系统开销时间）。
 
 

动态测试：基准程序（跑分软件）是用来测量计算机处理速度的一种实用程序，以便于被测量的计算机性能可以与运行相同程序的其他计算机性能进行比较。

**思考：**
1、主频高的CPU一定比主频低的CPU快吗？
答：不一定，如两个CPU，A的主频为2GHz，平均CPI=10，一秒钟可以执行0.2G条指令；B的主频为1GHz，平均CPI=1，一秒钟可以执行1G条指令。
2、若A、B两个CPU的平均CPI相同，那么A一定更快吗？
答：不一定，还要看指令系统，如A不支持乘法指令，只能用多次加法实现乘法；而B支持乘法指令。
3、基准程序执行的越快说明机器性能越好吗？
答：基准程序中的语句存在频度差异，运行结果也不能完全说明问题。

**知识点回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fe5a13439363496a94f223aa72ab8182.png)
存储器的容量：衡量计算机的存储容量
机器字长：衡量计算机并行处理的能力
数据通路带宽：衡量计算机在功能部件之间传送数据的能力
# 二、数据的表示和运算
![在这里插入图片描述](https://img-blog.csdnimg.cn/4d2275ab83624328a031d2eb0b59460c.png)
## 2.1
### 2.1.1 进位计数制

**任意进制转换成十进制**

![在这里插入图片描述](https://img-blog.csdnimg.cn/38a909df9b864b9bac32c8cb9ed8c0dc.png)
**二进制<=>八进制、十六进制**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f49e457e4a294d3aa905938f6d29f0f1.png)
**各种进制的常见书写方式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a4045550f3024030af46b5c0f18c3362.png)
**十进制转换成任意进制**
![在这里插入图片描述](https://img-blog.csdnimg.cn/4258f531225747f1bce7dbf9e2998b39.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/0994b185e0fe4734a0c84a8ee2a59676.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/adc0359ed9d1461eb4f7c0074cabf7fa.png)

**真值和机器数**
![在这里插入图片描述](https://img-blog.csdnimg.cn/53fb9474dc32414a80a2f7c539c3b86d.png)
**知识回顾与重要考点**
![在这里插入图片描述](https://img-blog.csdnimg.cn/1dbc8c9ce4d844f1928f8f1affb8191c.png)
### 2.1.3 无符号整数的表示和运算
无符号整数，即“自然数”，0、1、2、3、4、5...

 C语言中的无符号整数：

```c
unsigned short a=1; //无符号整数 （短整型 2B）
unsigned int b=2; //无符号整数 （整型 4B）
```
无符号整数的表示
![在这里插入图片描述](https://img-blog.csdnimg.cn/c7c1d87e1c054f6abfa6ce98fddb43a2.png)
无符号整数的加法运算
![在这里插入图片描述](https://img-blog.csdnimg.cn/7f6a2599c2b84da9be9c0992d9fe0f9a.png)
无符号整数的减法运算
![在这里插入图片描述](https://img-blog.csdnimg.cn/d6314775bc1f4f00bcf8c8e8f80d7a58.png)
### 2.1.4 带符号整数的表示和运算_原反补
带符号整数，即“整数”，-2、-1、0、1、2、3、4、5...

 C语言中的带符号整数：

```c
short a=1; //带符号整数 （短整型 2B）
int b=-2; //带符号整数 （整型 4B）
```
原码表示
![在这里插入图片描述](https://img-blog.csdnimg.cn/1253abc4a1ab43c69a287074ab8466d6.png)

 原码的缺点：符号位不能参与运算，需要设计复杂的硬件电路才能处理
 用补码表示真值--符号位可以参与运算

**原码、反码、补码的转换（计算）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/88410a4f5ef748f593dfbf3f380b7954.png)
**原码、反码、补码快速转换技巧（手算）**

![在这里插入图片描述](https://img-blog.csdnimg.cn/decbde47010a4f558683906e1f1647dc.png)
补码的加法运算（例1）
![在这里插入图片描述](https://img-blog.csdnimg.cn/bce4223417374f91921682339444fbf8.png)
补码的加法运算（例2）
![在这里插入图片描述](https://img-blog.csdnimg.cn/41038554f3af4558841c7d5e33768de8.png)
补码的减法运算
![在这里插入图片描述](https://img-blog.csdnimg.cn/a9ad3fa53a3c48dd86e915429fb68c4a.png)
补码的减法运算（例3）
![在这里插入图片描述](https://img-blog.csdnimg.cn/d00d005b063d4881bcb9829932824054.png)
注：对比无符号整数的减法运算。优点：用同一套电路即可处理所有的加减法，省钱！
知识回顾与重要考点
![在这里插入图片描述](https://img-blog.csdnimg.cn/b431290623d246dab197b6e5877e6378.png)
### 2.1.5 原反补码的特性对比
![在这里插入图片描述](https://img-blog.csdnimg.cn/10f089df965e4e309be8f626e1ed090b.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/188fd45b7eb3433581adfe874fe7ff7e.jpeg)
注：反码与原码表示的范围是一样的，当n是整数时，真值负数最小时，原码是1111 1111，反码是1000 0000。

### 2.1.6 移码
![在这里插入图片描述](https://img-blog.csdnimg.cn/4aba2f0ee1384c9a8d97c1098880c873.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/bd9dbf5a74c54ff98726a9ac19e5bdcc.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/a19cd1d072184a3d866f9bd9d20750ad.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/426d9ea3ab2c43afb0d81b6edac78e76.png)

### 2.1.7 定点小数
![在这里插入图片描述](https://img-blog.csdnimg.cn/2e795c25b53f4428b5485483fc3ca826.png)
**定点小数的原码**
![在这里插入图片描述](https://img-blog.csdnimg.cn/8933508c1c2448c0a0c7f297af5a1e88.png)

**定点小数原反补码的转换**
![在这里插入图片描述](https://img-blog.csdnimg.cn/892024cd3ff44ba78bc9c64e1f69bc44.png)
注：和定点整数一模一样。

**定点小数的加减法运算**
![在这里插入图片描述](https://img-blog.csdnimg.cn/0748882a0c08420aa8b114baae146877.png)
小数的加减运算和整数的处理逻辑是一样的。

定点小数VS定点整数
![在这里插入图片描述](https://img-blog.csdnimg.cn/220a8b1821f5497bbfc262be0eeb640c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ac0d17b263524b599a9b7f3a37be4c1d.png)
## 2.2
![在这里插入图片描述](https://img-blog.csdnimg.cn/29f661614d564cfc939d9bce64250b6c.png)

### 2.2.1 电路的基本原理、加法器设计
**ALU（算数逻辑单元）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f4230076a5a34ce994efe73517d4f6d6.png)
**基本的逻辑运算**

![在这里插入图片描述](https://img-blog.csdnimg.cn/ba4948e0e81b41bda1ec213e023539ae.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/daf7c48a49504027bf82d1698e241975.png)

**复合逻辑**
![在这里插入图片描述](https://img-blog.csdnimg.cn/dbfc08295d7645a1b6cf566c034a34cf.png)
异或：AB不同Y为1，相同为 0；同或：AB相同Y为1，不同为0。
**一位全加器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fbe2d46c414b4f9d8d400ba7904f8b8b.png)
如果输入（Ai、Bi、Ci-1）只有一个1，那么进位为0；若输入至少2个1，则进位为1。

**串行加法器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/ad36e8dd14384b81a86521a1a392b4f0.png)

**并行加法器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f8d48537f6744e54a2afa1afaafbe32c.png)

**本节总览**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fe645c65b6f04efeb989890a36f98a63.png)
### 2.2.2 并行进位加法器
![在这里插入图片描述](https://img-blog.csdnimg.cn/940d4b8b2437466f9037ba59a6eb27f9.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7786431f9747471eaed19e4a11df3b56.png)

G1、P1在C1、C2、C3、C4的运算当中，可以把G1、P1送到后边的全加器里。G2、P2......也是如此，一般套娃到C4就会结束，不然电路就会很复杂。

### 2.2.3 补码加减运算器
加法器原理
![在这里插入图片描述](https://img-blog.csdnimg.cn/878d10362ffe4a2c93da28c1edb2d027.png)
cin是加到A和B的最低位，cout是A和B的最高位相加后向更高位产生的一个进位信息。

![在这里插入图片描述](https://img-blog.csdnimg.cn/f6eb4ee2943348ac8e702e785ca57e16.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b354121235de4d068528c49e2ac5c332.png)


计算机底层的硬件在处理加法或减法时，不论输入的是有符号数还是无符号数，底层的硬件都是用同一套电路来处理的，最后在我们判断是否发生溢出的时候，有符号数的判断逻辑和无符号数的判断逻辑存在显著区别。那有符号数和无符号数是如何判断溢出的呢？
### 2.2.4 标志位的生成
![在这里插入图片描述](https://img-blog.csdnimg.cn/9e9a07483a6a4525adb6897943103a97.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/cdea1cd857094791a7b758f1630cb184.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/141379e9705a4d4f8b2263913b4b1341.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e7849854ec364394b74bdfefbba3fd70.png)

### 2.2.5 定点数的移位运算
**原码算数移位**
![在这里插入图片描述](https://img-blog.csdnimg.cn/958969395e8c485b808c20f134c327d1.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ad7c1ac27aa74d6bbd13b3958a005ba2.png)
注：定点小数算数移位同理。

**反码的算术移位**
![在这里插入图片描述](https://img-blog.csdnimg.cn/15255a0c4d834df4bb91e4bb9425ec1c.png)
**补码的算术移位**
![在这里插入图片描述](https://img-blog.csdnimg.cn/58b2b32a00c7494eaf4587ea60368846.png)
**总结**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fc9ec36dd85f4b96b589cf97f90502e2.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/6459595c02a34ffbae06b8c96a9de915.png)

**逻辑移位（无符号数算术移位）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/53d2e39ac4cb4cf5b24dfc8aad5b4568.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/76c6657096a74e1b93c00ce23c4b35f8.png)
**循环移位**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c709b033252446fcbe2bf27c8f9c7537.png)
**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/6ec3a5f2d202406f84afa0ae65165541.png)
### 2.2.6 原码、补码乘法运算
**1、原码乘法运算**
手算乘法（二进制）
![在这里插入图片描述](https://img-blog.csdnimg.cn/b4316d478af748998c7f6a579e5e919f.png)
原码一位乘法（小数）

![在这里插入图片描述](https://img-blog.csdnimg.cn/284e7c2f67e948ce9d7c9778dcc9855f.png)![在这里插入图片描述](https://img-blog.csdnimg.cn/fcaa28b713df493d904c6f6eec8f5192.png)
当前位为1，则ACC加上被乘数，之后更新ACC。
![在这里插入图片描述](https://img-blog.csdnimg.cn/eb5f281574204a5c9f5ca57400231fb9.png)

第一个位基（01101）和第二个位基（01101）相加的时候，需要错位，计算机处理的方式是将ACC、MQ里的数据统一右移一位。
![在这里插入图片描述](https://img-blog.csdnimg.cn/8db3e89e4c9a455aa41b451789d82347.png)
当前位为1，则ACC加上被乘数，之后更新ACC。
![在这里插入图片描述](https://img-blog.csdnimg.cn/335cacfb1c2d4fa8abd4c4239bac7d01.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f67c7bc7d0c246218485fd75fbd0992a.png)
当前位为0，则ACC加上0，ACC的值不变，ACC、MQ里的数据逻辑右移一位。右移后当前位为1，则ACC加上被乘数，更新ACC。

![在这里插入图片描述](https://img-blog.csdnimg.cn/2e1385565d384eafa85ad4750706a294.png)
统一右移一位之后，当前位是乘数的符号位，不参与运算，此时已经重复4次。
![在这里插入图片描述](https://img-blog.csdnimg.cn/bfd0bccfafad411ba257701c0dd4ea2e.png)
最后不要忘了修改符号位。
![在这里插入图片描述](https://img-blog.csdnimg.cn/f93b1c3172a14c1a8e94ffb4d77ac068.png)
原码一位乘法手算模拟
![在这里插入图片描述](https://img-blog.csdnimg.cn/30a616eac92342af9e2de42d0914b10f.png)注：以上是小数的一位乘法，整数的一位乘法类似。只需把小数点改成逗号，注意整数小数点固定位置。
![在这里插入图片描述](https://img-blog.csdnimg.cn/c18c5ed276164f5bab3b252bda9e9536.png)
**2、补码乘法运算**

补码一位乘法
![在这里插入图片描述](https://img-blog.csdnimg.cn/f15f237aba9e4574bdf8797ff8c544ce.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/aa89697e7e27441fad8b759d7a0d4bcb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f8fef72340014dfeac8c0b2039c7f71f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/78d2f7cff18e469abda2684a0b8c3420.png)

### 2.2.7 原码、补码除法运算
**1、原码的除法运算**
手算除法（十进制）
![在这里插入图片描述](https://img-blog.csdnimg.cn/571d253cd6b3464484e232b1b9f1f4df.png)
手算除法（二级制）
![在这里插入图片描述](https://img-blog.csdnimg.cn/43b36276d4c64300b7e6d59557a20ca4.png)
原码除法：恢复余数法
![在这里插入图片描述](https://img-blog.csdnimg.cn/75257ba3ae984b1ba77225cd1f160b37.png)
将ACC的值更新为11110，此时相减结果是个负数，说明应该上商0。恢复余数。
![在这里插入图片描述](https://img-blog.csdnimg.cn/ae9ce211165b49749a198b2a483c779e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ba8d58899f3448c3bf68eabc4fb4e4ac.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1d05dd6577e44d5d9bc23639d915ddac.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d8b67c79126547b291b81b1a61ea17a7.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a55012b97d2b4c61a0dffe36379929ad.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/93d7a7c9110b4a92a84e3504357c6d74.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/24111ad86add4e76b08af47701c1a771.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9fec587a509e4780b95114fbb4ee9365.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4e41d71e256d4ec8a0339346aa6bd13f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/37a909f25dc74afeba8a390bef678782.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/60a2e4f4085c405f92ee96d3f6af0d4a.png)
x,y均为0，异或之后结果为0.则符号位为0.
![在这里插入图片描述](https://img-blog.csdnimg.cn/e74e28963e434fe3a9384ed7bd9a96a5.png)
原码除法：恢复余数法（手算）
![在这里插入图片描述](https://img-blog.csdnimg.cn/9b957cda1c534555b4f816aac9e72d27.png)
原码除法：加减交替法（不恢复余数法）
![在这里插入图片描述](https://img-blog.csdnimg.cn/840fc81da5964d6aaecb3d70acf7ac7d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e612a3af64ce478c8339b98aa1b90052.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1346f066963c4e4ba644493d84f77bda.png)
注：定点小数的除法运算，最后的商也必须是定点小数，因此在除法运算中，我们规定被除数一定要小于除数。如果被除数大于除数，商就会大于1，而定点小数无法表示大于1的范围。通过第一步的商，如果商为1，那么硬件电路就会检测出这个问题，并停止除法运算。
**2、补码的除法运算**
补码除法：加减交替法
![在这里插入图片描述](https://img-blog.csdnimg.cn/bc876e38306e410aa6006de00621aa17.png)
异号相除：够减商0，不够减商1
同号相除：够减商1，不够减商0

够减：被减数绝对值大于减数
![在这里插入图片描述](https://img-blog.csdnimg.cn/37a80fb119924823938272a742f681d1.png)

**3、除法运算总结回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/268199a1a9594cf2b2417ec1b6f04e44.png)
### 2.2.8 C语言类型转换
![在这里插入图片描述](https://img-blog.csdnimg.cn/f79132e94fc0439fbf64c2542a131538.png)
### 2.2.9 数据的存储与排列
大小端模式
![在这里插入图片描述](https://img-blog.csdnimg.cn/a9e897a2f2db4339a6dc1f8a43da019b.png)
边界对齐
![在这里插入图片描述](https://img-blog.csdnimg.cn/7e8853b39c984e0b873887c6285d62e7.png)
边界对齐方式：起始地址能被自身长度整除！
## 2.3 
### 2.3.1 浮点数的表示
定点数的局限性：定点数可表示的数字范围有限，但我们不能无限制的增加数据的长度。
**从科学计数法理解浮点数**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b92a195318494bc5918bce4673247061.png)
**浮点数的表示**
![在这里插入图片描述](https://img-blog.csdnimg.cn/320362df0892496da50959d0da5c36a3.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b52029b9254f4862988687d73f86f5f1.png)
**浮点数尾数规格化**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f63da4ba715f4a93be9a8084a30b6afb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b2571d407fbc45ec8a230d75aea4c37c.png)
**规格化浮点数的特点**![在这里插入图片描述](https://img-blog.csdnimg.cn/2e5e1dedabc248cebc4652ca2802c85d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d3a3ba4702224bacb2b9e7c81e0d00d6.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e45e5aab75d3466fac2e36519584191a.png)

知识点回顾
![在这里插入图片描述](https://img-blog.csdnimg.cn/9518e3762fa34f348da33eea23a2cdb0.png)
### 2.3.2 IEEE754
**移码**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a9f141f208f141fbb1273270bf56940c.png)
这个运算有点特殊。
![在这里插入图片描述](https://img-blog.csdnimg.cn/9cc3264aec884827aab481f979dbc1dd.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/55221aa37468495d9bce0e089caa5945.png)
当偏置值为2^n-1时，此时移码相对于之前整体下移了一位。

**IEEE754标准**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c851961526494010a668f6f28e0d2051.png)
看两个例子，就明白了十进制与IEEE754的转换过程了。
![在这里插入图片描述](https://img-blog.csdnimg.cn/7493c581e62348598f53f28f24c7c6b8.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f54bd4423fad4b75827f903def8ba90f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/2c753501eefb4bef92cf99cbf84fa1bb.png)
若要表示的数绝对值还要更小，怎么办？【阶码全1，阶码全0用作特殊用途】
单精度浮点数阶码占8bit,能表示范围0~255。0代表全0，255代表全1。
![在这里插入图片描述](https://img-blog.csdnimg.cn/6b9a2e05fcb847e989bb72ade231ceef.png)
**知识点回顾**
![](https://img-blog.csdnimg.cn/d21ce57d21de4a56a831b3d469f5c16c.png)
### 2.3.3 浮点数的运算
**浮点数的加减运算**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b1d5e7a9e7cf4aa88cbae4617ace4382.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/80e558c09de54e518b07ee440d2802d5.png)
X=-0.101×2^(-101)
-0.101:  补码：**1**.011  双符号位补码：**11**.011   扩展：**11**.011000000
2^(-101):  补码：**1**011  双符号位补码：**1**1011

**浮点数的加减运算-舍入**
![在这里插入图片描述](https://img-blog.csdnimg.cn/8ea6c7464fb04d18a13a288d80c0fe35.png)
**强制类型转换**
![在这里插入图片描述](https://img-blog.csdnimg.cn/5dcc08b0f2934c67b2d4181106586763.png)
本节回顾
![在这里插入图片描述](https://img-blog.csdnimg.cn/e569017b8b8b4a9e8ce01d235b38e87f.png)
# 三、存储系统
## 3.1 存储系统基本概念
存储器的层次化结构
![在这里插入图片描述](https://img-blog.csdnimg.cn/e4d08c8cc7d5443aaf7c02e73eaa2b7c.png)
存储器的分类--层次
![在这里插入图片描述](https://img-blog.csdnimg.cn/ab0aa1bc506d48caaaecf677085f949d.png)
存储器的分类--存储介质

 - 半导体存储器：主存、Cache
 - 磁表面存储器：磁盘、磁带（以磁性材料存储信息）
 - 光存储器：光盘（以光介质存储信息）

存储器的分类--存取方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/f6ce2e99511d4b6980c7b861125129ca.png)
相联存储器既可以按地址又可以按内容寻址。

存储器的分类--信息的可更改性

 - 读写存储器--即可读、也可写（如：磁盘、内存、Cache）
 - 只读存储器--只可读，不能写

存储器的分类--信息的可保存性  

 - 断电后，存储信息消失的存储器--易失性存储器 (主存、Cache)
 - 断电后，存储信息依然保持的存储器- -- 非易失性存储器(磁盘、光盘)
 - 信息读出后，原存储信息被破坏-- -破坏性读出(如DRAM芯片，读出数据后要进行重写
 - 信息读出后，原存储信息不被破坏-- - 非破坏性读出(如SRAM芯片、磁盘、光盘)
 
 RAM都是易失性存储器；
 ROM都是非易失性存储器；
 随机存取存储器：RAM（专有名词）；
 随机存取：是存取方式，ROM和RAM存取方式都是随机存取。
 
 **存储器的性能指标**
![在这里插入图片描述](https://img-blog.csdnimg.cn/ca076aaecdb74ff0b3c03996140adc4f.png)
**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/8173856c8d314351ba2cf622992c424e.png)
## 3.2
### 3.2.1 主存储器的基本组成
**基本的半导体元件及原理**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fc600532a7254be9803114f6595f96e9.png)
注：MOS管可理解为一种电控开关，输入电压达到某个阈值时，MOS管就可以接通。

**存储器芯片的基本原理**
![在这里插入图片描述](https://img-blog.csdnimg.cn/59861150f9394e868b33f4d0c98aaf55.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/8e1d7083a1134880b4cf545c2fd5b640.png)
驱动器在译码器后面，保证译码器输出的电信号是稳定可靠的。
片选线作用：若有多个存储芯片，保证此次读取指定芯片的数据，CS给予低电平，其他芯片为高电平。

![在这里插入图片描述](https://img-blog.csdnimg.cn/60f7e14e36344217b7af02f33d43edb3.png)


**寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/0f52bcc7fbae4c72bac4fa659291df26.png)
本节回顾
![在这里插入图片描述](https://img-blog.csdnimg.cn/ff1563f180b2406ba40779fc3e4b250c.png)
### 3.2.2 SRAM与DRAM

DRAM（动态RAM）用于主存，SRAM（静态RAM）用于Cache
DRAM芯片：使用栅极电容存储信息
SRAM芯片：使用双稳态触发器存储信息
![在这里插入图片描述](https://img-blog.csdnimg.cn/37fd6be103ec4dc7a3f6051acbf20fe2.png)

1：电容内存储了电荷
0：电容内未存储电荷
若触发器里存储的的二进制的1，当字选择线接通之后，BLX输出低电平信号
若触发器里存储的的二进制的0，当字选择线接通之后，BL输出低电平信号
写入0：给BL加低电平，给BLX加高电平，呈现A低B高
 栅极电容：每个存储元制造成本更低，集成度高，功耗低。电容内的电荷只能维持2ms，即便不断电，2ms后信息也会消失，2ms之内必须“刷新”一次（给电容充电）
 双稳态触发器：每个存储元制造成本更高，集成度低，功耗大。只要不断电，触发器的状态就不会改变
 
**DRAM的刷新**
 
![在这里插入图片描述](https://img-blog.csdnimg.cn/e8d00dfe9ff54b999bae7860d362df29.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/638f4cff38184dbd80c897393ff800bb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/91d00cf9788c49019de9838215335367.png)
分散刷新不存在死区

**DRAM的地址线复用技术**
![在这里插入图片描述](https://img-blog.csdnimg.cn/46f777c88634418a930c55089859e0d8.png)
地址：00000000。
同时送行列地址，需要8根地址线。两次送只需要4根地址线。
地址线复用技术：地址线是原来的1/2（行和列相等）且地址线分行、列两次传送。
这里地址线取决于行和列的最大值。
地址引脚：log2max{行，列}

![在这里插入图片描述](https://img-blog.csdnimg.cn/3ddfee07fcb040f9a659f0120b5b9ff9.png)
### 3.2.3 只读存储器ROM
![在这里插入图片描述](https://img-blog.csdnimg.cn/fff92eeb2e884532a47b7af43d4b870e.png)
EPROM不能作为随机存储器。
![在这里插入图片描述](https://img-blog.csdnimg.cn/d9deaee501f04a9381527db052c6a89f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/5e1ed22e6cf94ca9be517671c822ad23.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d383733ed4c04de9bbfeed289b1f7020.png)
## 3.3
### 3.3.1 主存储器与CPU的连接
现在的计算机
![在这里插入图片描述](https://img-blog.csdnimg.cn/c8741e3f2c0a4c61870d3e30182b6d13.png)
**存储器芯片的输入输出信号**

WE头上没有横杠，高电平表示写，低电平表示读。
![在这里插入图片描述](https://img-blog.csdnimg.cn/bfb73cda8fc345c3bdfcdf440fe0746d.png)
**增加主存的存储字长-位扩展**
![在这里插入图片描述](https://img-blog.csdnimg.cn/0e6f7ff7764041df88a8fa51a868804c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b4b05e96cd56455f9416b22da917042e.png)
**增加主存的存储字数-字扩展**
**线选法**
![在这里插入图片描述](https://img-blog.csdnimg.cn/71010892b64745dd988abe267949eaa5.png)
**译码片选线**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a0924da3a8794ac8a0709fd7afb5eeee.png)


![在这里插入图片描述](https://img-blog.csdnimg.cn/6460da67bd0449de87828b7dcb4bde1e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/404af484527945b18079f87aa9a6a090.png)
**主存容量扩展-字位同时扩展**
①可以存储低四位--（D0、D1、D2、D3）
②可以存储另四位--（D4、D5、D6、D7）
![在这里插入图片描述](https://img-blog.csdnimg.cn/31860d76ca304efea2024e9fb5234cd4.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/3e0861ff7cff44d0a34d6480634d1386.png)
**补充：译码器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/059257d21292496f955c56f97548d8bc.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/bf09d685e85f424b95ddada915111a01.png) 
![在这里插入图片描述](https://img-blog.csdnimg.cn/9f1af941323044a0aff9b61453f2bef1.png)
### 3.3.2 双端口RAM和多模块存储器
![在这里插入图片描述](https://img-blog.csdnimg.cn/f5751eb0275541a98933f1ff4c72fb13.png)
**双端口RAM**
![在这里插入图片描述](https://img-blog.csdnimg.cn/6042f139bf9c4c3499f04e11efbc6071.png)
**多体并行存储器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/9d8b4c468ad9400fab32db2fd648e3ba.png)

**应该取几个“体”**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f90babed97c24cbb81d813e4e712e923.png)


当m=T/r时，存取流水线的效率最高，存储体的数量最少，成本最低。
思考？
假设有m个存储体，第一种方法：可以根据体号确定它属于第几个存储体；第二种方法：用十进制地址x对m取余
 
**多模块存储体**
![在这里插入图片描述](https://img-blog.csdnimg.cn/053fd9c6aeb044f293735a02b34e8baf.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e602ec9cbc594fa0b6f746646ef8363d.png)
## 3.4
### 3.4.1 磁盘存储器
**外存储器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b2a09917ed77463184c1fcf2dd7d4f38.png)
**1、磁盘设备的组成**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b95a0d99187547dbae39cd2e4a4d3c6b.png)
**2、磁盘的性能指标**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d7e05f2a415d4922ad95c2cbf30d21b9.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/280f5ad2889846fdace7cb1e3ca17b01.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/858f98e3b788489caa11be6346ade2c7.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ee8e8a2d60e9499a94b3dd621c733310.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b01324025e7449e09faf504b5ece1250.png)
**磁盘阵列**
![在这里插入图片描述](https://img-blog.csdnimg.cn/477ecb9888cf4275899c2f8b52c7a794.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/5bb61755c73f4d738e8ab9704760b248.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/56e1ea7e105544ac9b764fcfaa31a626.png)
RAID0-->RAID5,冗余信息占比越少。
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b61a9832eb954737ab5487121c55e193.png)
### 3.4.2 固态硬盘SSD
**固态硬盘的结构**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d62b4dd34b8f4a6bb78f4d9a631b5d9a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e5a14a90505c4c29b6a79cc9db5cefc2.png)
## 3.5
### 3.5.1 Cache基本概念和原理
**局部性原理**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f23635fe05f948c5937aa63dfa3b279d.png)
**性能分析**
![在这里插入图片描述](https://img-blog.csdnimg.cn/ca5db83468aa4c5a910cead0fae69279.png)
**有待解决的问题**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7cc2b9b6211a46a7ba8dd6367e416770.png)
注：每次被访问的主存块，一定会被立即调入Cache.

 - 如何区分Cache与主存的数据块对应大小--Cache和主存的映射方式
 - Cache很小，主存很大。如果Cache满了怎么办--替换算法
 - CPU修改了Cache中的数据副本，如何确保主存中数据母本的一致性--Cache写策略

**知识回顾**

![在这里插入图片描述](https://img-blog.csdnimg.cn/910908da40564dc783e56f62725f26dc.png)
### 3.5.2 Cache和主存的映射方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/416eabc235f84f358ac000cf4834bc8c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/38a5ab98b50a46a8bf2a749e4c91b294.jpeg)

**全相联映射**
![在这里插入图片描述](https://img-blog.csdnimg.cn/561a8915fe2845c595592021dfaea8c4.png)
**直接映射**
主存块号%2^3,相当于留下最后三位二进制数
若Cache总块数=2^n,则主存块号末尾n位直接反映它在Cache中的位置
将主存块号的其余位作为标记即可
![在这里插入图片描述](https://img-blog.csdnimg.cn/1533afcb4c0a4788950e1b45a7b9e18e.png)


**组相联映射**
![在这里插入图片描述](https://img-blog.csdnimg.cn/3ee328212a654b82bea4b6441ead54ad.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/65d80777f5b84c9198fc56cc5171737a.png)

Cache行：标志位（有效位、一致性维护位、替换算法控制位、标记位）+数据位（存放数据）
注意区分cache行和cache地址，装入cache的地址是低c+b位![在这里插入图片描述](https://img-blog.csdnimg.cn/0e5c22098cff4dea9187910ac0dff5e6.jpeg)cache容量：是指cache存储数据的大小；cache总容量：是在cache容量基础上，加上所有标记cache块的地址所占的内存。

**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/5f1852e0d6734334985ca82e8715fae3.png)
### 3.5.3 Cache的替换算法
**随机算法RAND**
![在这里插入图片描述](https://img-blog.csdnimg.cn/544855683da74dd498a52bbf58554c70.png)
**先进先出算法（FIFO）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/53ba7f128b40469abebc75a6c68959a2.png)
**近期最少使用算法（LRU）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a4dd0b48d29d4badb570ae99635f10be.png)
如上图4个Cache块，只需要2bit的信息来表示计数器，刚好可以表示0、1、2、3这四种数字。使得硬件电路变得很简单。
LRU算法--基于“局部性原理”，近期被访问过的主存块，在不久的将来很可能被再次访问，因此淘汰最久没被访问过的块是合理的。LRU算法的实际运行效果优秀。Cache命中率高。
若被频繁访问的主存块数量>Cache行的数量，则有可能发生“抖动”，如：{1、2、3、4、5、1、2、3、4、5...}
**最不经常使用算法（LRU）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e81f7946036a4ce6a691a4a6ced79566.png)
**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7caf5f5ab9084b44a6059e4ed5710742.png)
### 3.5.4 Cache写策略
**写命中--写回法**
![在这里插入图片描述](https://img-blog.csdnimg.cn/1aaa24958f4b415792aa2684a9b7c09a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7d96c2e045834a05b70f84a73a48d1af.jpeg)

**写命中--全写法**
![在这里插入图片描述](https://img-blog.csdnimg.cn/304f70573b9e44db9aec3b9962240e65.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/eb12db7d66124d30b943e692a5978f6d.png)
**写不命中--写分配法**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c7d989b303aa4f3584c4205e5d97182f.png)
**写不命中--非写分配法**
![在这里插入图片描述](https://img-blog.csdnimg.cn/039fecd40f03483c855b440b10af293c.png)
**多级Cache**
![在这里插入图片描述](https://img-blog.csdnimg.cn/453d8995a3504d4594ed6ddbf7d030f1.png)
现代计算机常采用多级Cahe，离CPU越近的速度越快，容量越少，离CPU越远的速度越慢，容量越大。

**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d098988eefe24759bb5904d2c1fd557e.png)
## 3.6
### 3.6.1 页式存储
![在这里插入图片描述](https://img-blog.csdnimg.cn/bd88f993ab0e4849b1742a54190bffca.png)
**逻辑地址VS物理地址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/75f0e83207d4400b8349aee0563968f2.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9232caa67d3c425d82b1079a90c35766.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/8fcc0399941b499983c9c2b62fc2aafe.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a37ad728ba794c128ca6e629ce9efded.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a675fbb79c0f43a287631bc35f999888.jpeg)

**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b3b948e1b36948a18568e0dfb73a51f8.png)
### 3.6.2 虚拟存储器
**页式虚拟存储器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/abafee2751d9471cb01103d771b9cf16.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/01e45cf6622d4c0db0b87119180e51c1.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c6647ea649cb4ea696f2eb6030b75176.png)
**段式虚拟存储器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/098362c28f00496085f90592e3477d5b.png)
**段页式虚拟存储器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/055a83025dac465d8f41af4322a081aa.png)
# 四、指令系统
## 4.1
### 4.1.1 指令格式
**指令的定义**
指令（又称机器指令）：是指计算机执行的某种操作的命令，是计算机运行的最小功能单位。
一台计算机的所有指令的集合构成该机的指令系统，也称为指令集。
注：一台计算机只能执行自己的指令系统，不能执行其他系统的指令。

**指令格式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/83afe5ed60db45168ee10b99633c9ee7.png)
**零地址指令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/2ad5c20bcede4f8e8601d3e98782b2c1.png)
**一地址指令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c560f68d25724e9db76333e5bee87ef7.png)
**二、三地址指令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/225befce47a5431580ceadfefb0586d1.png)
**四地址指令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/4c77e6b6f4f146a49c7441b6ce62de8d.png)
**指令-按地址码数目分类**
![在这里插入图片描述](https://img-blog.csdnimg.cn/85a032eb86de446eb68559ebe5745f77.png)
**指令-按指令长度分类**
![在这里插入图片描述](https://img-blog.csdnimg.cn/16df52b2228541f0b340646c7cb2c480.png)
机器字长和存储字长固定不变。

**指令-按操作码长度分类**
![在这里插入图片描述](https://img-blog.csdnimg.cn/42c6672de0a64966b5e18e5d1a48351b.png)
**指令-按操作类型分类**
![在这里插入图片描述](https://img-blog.csdnimg.cn/efcf31514b7a4138af19ea6956064791.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/818219eb67434b068d9f3ad63e40b57c.png)
### 4.1.2 扩展操作码指令格式
指令由操作码和若干地址码组成
定长指令字结构：指令系统中所有指令的长度相等。
变长指令字结构：指令系统中所有指令的长度不等。
定长操作码：指令系统中所有指令的操作码长度相等
可变长操作码：指令系统中所有指令的操作码长度可变
定长指令字结构+可变长操作码-->扩展操作码指令格式（不同地址数的指令使用不同长度的操作码）
![在这里插入图片描述](https://img-blog.csdnimg.cn/d39e1269066144108188b2c95feaca54.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/43ca0322b8f44a9ca1eba6f6cdd3d4a7.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7f37067ad4ec44938c3b71896721e59e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c8270bc03b2842e0be2d3afb7193e1d8.png)
## 4.2
### 4.2.1 指令寻址
**顺序寻址（PC）+“1”-->PC**
![在这里插入图片描述](https://img-blog.csdnimg.cn/164fe2c20cb24a54b39318e6cf74c85c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d88f7433914b4bf89e36b519028d31c5.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/1cc829001a6f45379649f7580acd6dfd.png)
**跳跃寻址：由转移指令指出**
![在这里插入图片描述](https://img-blog.csdnimg.cn/dccc46946f9e4f8e85d4ee2fec26d4f4.png)
**本节回顾**

 1. 转移指令是通过修改PC实现的
 2. 程序计数器PC：存放下一条指令所在单元的地址
 3. 累加器ACC：用来存放操作数或运算结果
 4. 指令寄存器IR：临时放置从内存里面取得的程序指令的寄存器，用于存放当前从主存储器读出的正在执行的一条指令。
 5. 地址寄存器MAR：用来保存当前CPU所访问的内存单元的地址。
![在这里插入图片描述](https://img-blog.csdnimg.cn/a19ead635ae240928712445111cb6425.png)
### 4.2.2 数据寻址
![在这里插入图片描述](https://img-blog.csdnimg.cn/85717423fd1a4157a48202445c51f9ac.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ccd91bea9d7342df9ebe794fe14aef3a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c0a024383ee6404fbd94d13b5b346451.png)
**直接寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7e47211b8709464ab65ce35509af863c.png)
**间接寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/ecec044969914e71a3a96319f4e031eb.png)
**寄存器寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b974a91331f649a4bfbd921f2c79a1e6.png)
**寄存器间接寻址**![在这里插入图片描述](https://img-blog.csdnimg.cn/0f9fde478025420bae962156174664d8.png)
**隐含寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fc23efb66bef434e9004c9e0f684df71.png)
**立即寻址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/93b1259d94c44441ab084f5e24a29cd1.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e26c5ff9740e4bbd959108247f22890c.png)
### 4.2.3 数据寻址--偏移寻址
![在这里插入图片描述](https://img-blog.csdnimg.cn/6c6a8fe859c24355a0c54dcafb682cb9.png)
**基址寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c825bae3db32432a92bec46cab403a49.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9b53be24ba8640ed98c5a970b4f655d8.png)
**变址寻址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/932b1b5e1e5448d48899af1922ae084a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/09e33a53f7ac4d8fb83a50f8d0d9e4d3.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d612dc7dd3414a89b9125fc2853aff4c.png)
**基址&变址复合寻址**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e66c151a60144fe595cb2dc7de4d9abc.png)
**相对寻址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/dcd38a3dae484181aff11fdad8c7cb09.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f8f7ddd4c30a404980479491cb856d34.png)
扩展：ACC加法指令的地址码可采用“分段”方式解决，即程序段和数据段分开。如果固定数组的首地址，那么数组地址7就不用改变。
![在这里插入图片描述](https://img-blog.csdnimg.cn/cb415f7df0104e15b67f315dfc3aef2f.png)

基址寻址中程序浮动指的是整段程序在内存里的浮动，相对寻址中程序浮动指的是一段代码在程序内部的浮动。

**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b813e17007cd40af8539b1818bd7fd7d.png)
**硬件如何实现数的“比较”**

![在这里插入图片描述](https://img-blog.csdnimg.cn/7780f22ee9d54537a83ce29a044e6684.png)
注：无条件转移指令jmp2，就不会管PSW的各种标志位。PC=2

### 4.2.4 数据寻址--堆栈寻址
![在这里插入图片描述](https://img-blog.csdnimg.cn/5c4b760a77cd40dd9cd906627092bb30.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/2f71676832d0463f99e28d035b52376c.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/dfc45cc1544e4de98b35d8550c2c6880.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/79ea726dbe474b5abf22fc81d023e1ae.jpeg)
## 4.3
### 4.3.1 高级语言与机器级代码之间的对应
![在这里插入图片描述](https://img-blog.csdnimg.cn/73a413cff2df4b13803033c1f16f47e3.png)


**X86汇编语言指令基础**

![在这里插入图片描述](https://img-blog.csdnimg.cn/b3394ff1692f4484a99dfc156575ce21.png)

**以MOV指令为例**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d7f97452b8614bff9296599c8a47112b.png)

**X86架构CPU，有哪些寄存器？**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b3c01fa29bd64a8a84c5f2573f29fcbc.png)

通用寄存器另外两种表示方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/b9c244288ca2432087e18d4293a4f17f.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/d9f1fee6bf7f47e8aad3aeafe56dc821.png)

更多例子
![在这里插入图片描述](https://img-blog.csdnimg.cn/719af64ec6344b8fbde0a911aabcd18f.png)

**总结**
![在这里插入图片描述](https://img-blog.csdnimg.cn/93a4ba7d80ea44ad87cf6147eca2965d.png)

### 4.3.2 常用的X86汇编语言指令
**常见的算数运算指令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/755a50dabdfc4594861983422b8c3105.png)

destination:目的地（d目的操作数）
source：来源地（s源操作数）
目的操作数d不可以是常量
在进行除法运算之前，需要把被除数位扩展， 
如32b/32b-->64b/32b,存放64位的被除数需要两个寄存器，edx:eax，高32位存放在edx,低32位存放在eax

![在这里插入图片描述](https://img-blog.csdnimg.cn/5cf8ffc663ec4bf190b6708c4503965e.png)

X86汇编语言当中不允许两个操作数同时来源于主存。

![在这里插入图片描述](https://img-blog.csdnimg.cn/1fb47661e10a4ffea67b8575d24a3c32.png)

### 4.3.3 ATu0026T格式和intel格式
![在这里插入图片描述](https://img-blog.csdnimg.cn/0e20837e83ae42448bb8554de47c685f.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/796d5f08a03546958217f27ecd954442.png)

### 4.3.4 选择语句的机器级表示
**程序中的选择语句（分支结构）**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a55fec92ff224bb4be695b8f3ab9de0e.png)
**无条件转移指令--jmp**
![在这里插入图片描述](https://img-blog.csdnimg.cn/04f1b03256d248078c75e592f01cb56b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c3e94085527041feaf681f988da096b9.png)
无条件转移指令，类似于c语言里的goto语句
无条件转移指令无法实现if,else语句

**条件转移指令--jxxx**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f3b9ab0a985f41219aadcb27ff85236e.png)
**示例：选择语句的机器级表示**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c1ccb83974fe4557bc63151e8c9a812e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b2d868be79fc4522936a3d8c776cfd46.png)
扩展：cmp指令的底层原理
![在这里插入图片描述](https://img-blog.csdnimg.cn/74aead3b956f48e3bf5d719fb71e5afc.png)
### 4.3.5 循环语句机器级表示
**用条件转移指令实现循环**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f43ff19fe22d4df49e898b92f8a9baec.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/50ba3947e64b4714ab3afb0c8ed6a0a5.png)
**用loop指令实现循环**

![在这里插入图片描述](https://img-blog.csdnimg.cn/03d963fbff3c4bc19571b0240bc5ee42.png)
## 4.4 CISC和RISC
![在这里插入图片描述](https://img-blog.csdnimg.cn/0e947b722aca4e9c9b998f2acedbba1e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4c69d47b0cc44aacad8f8cbe203c2818.png)
# 五、中央处理器
## 5.1 CPU的功能和结构

 1. 指令控制。完成取指令、分析指令和执行指令的操作，即程序的顺序控制。
 2. 操作控制。一条指令的功能往往是由若干操作信号的组合来实现的。CPU管理并产生由内存取出的每条指令的操作信号，把各种操作信号送往相应的部件，从而控制这些部件按指令的要求进行动作。
 3. 时间控制。对各种操作加以时间上的控制。时间控制为每条指令按时间顺序提供应有的控制信号。
 4. 数据加工。对数据进行算数和逻辑运算。
 5. 中断处理。对计算机运行过程中出现的异常情况和特殊请求进行处理。
 
 ![在这里插入图片描述](https://img-blog.csdnimg.cn/43507197dc9d436686a9f5c43a916a7b.jpeg)
![在这里插入图片描述](https://img-blog.csdnimg.cn/34dd8eb8ecd44d968e07bcfda47747d9.jpeg)
存储器容量：决定了计算机需要用来进行寻址的比特数，决定了地址的长度。

![在这里插入图片描述](https://img-blog.csdnimg.cn/81867716f46042d098fdb455590cafc4.png)
**运算器的基本结构**
![在这里插入图片描述](https://img-blog.csdnimg.cn/706a98bff1fe4859b45e2136ff5a0298.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/44ea1d9457e74c00af5b161ab09e7d43.png)
CPU内部单总线方式：将所有寄存器的输入端和输出端都连接到一条公共的通路上。


如：两个操作数分别来自主存和R0，最后结果存回R0，那么从主存中取来的操作数直接放入暂存器，就不会破坏运算前R0的内容。


在R0给的信号不稳定之前，ALU会产生一个输出信号送到内部总线上，就会与R0送到内部总线上的信号冲突，从而导致运算的错误。在ALU的输出端加一个暂存寄存器，等R0送到总线上的信号稳定之后，ALU把运算的结果放到暂存寄存器中，在ALU的输出稳定之后，让三态门导通，把运算结果送到内部总线上，给R0的输入端加上有效的电信号，就会把运算的结果输入到R0寄存器中。

![在这里插入图片描述](https://img-blog.csdnimg.cn/c6c16bc5e9a340cea283594792a4d9a2.png)
**控制器的基本结构**
![在这里插入图片描述](https://img-blog.csdnimg.cn/07f2f702aa824496bc7c3c22c8558359.png)
**CPU的基本结构**
![在这里插入图片描述](https://img-blog.csdnimg.cn/35f82ab9729347a7821b39eef3f7066d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c8cf82d3ada34516a66aadceaff8bf9c.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/0ef7cc0d40d14600aec6b9ee4ffb92ba.png)
## 5.2 指令周期的数据流
![在这里插入图片描述](https://img-blog.csdnimg.cn/2aa52c0cf7944afca39dee620760708e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c54cd3cf1f7142c7a2658e9b9141570a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7964749ba3d54565b579d4b1345c56d6.png)
**指令周期流程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e4b4bbc7e5f64ae0a338f4a9d173afb0.png)
**指令周期的数据流-取址周期**
![在这里插入图片描述](https://img-blog.csdnimg.cn/f75abfddae374d5a9dea3381b89eefdd.png)
**指令周期的数据流-间址周期**
![在这里插入图片描述](https://img-blog.csdnimg.cn/bcbf10120618437e9cd834a5e3df3835.png)
**指令周期的数据流-执行周期**
执行周期的任务是根据IR指令字的操作码和操作数通过ALU操作产生执行结果。不同指令的执行周期操作不同，因此没有统一的数据流向。

**指令周期的数据流-中断周期**

![在这里插入图片描述](https://img-blog.csdnimg.cn/22d534177336404389d46a2d25b75bee.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/8f1c442731b0418cabd5f358609530b8.jpeg)
**指令执行方案**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c4718eb2a1134cc78d659e665065de1b.png)
**本节回顾**

![在这里插入图片描述](https://img-blog.csdnimg.cn/6f30e759dada4fafb71a98368b2878f3.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/529dce22601a42bfa58aec275c19f0d9.jpeg)
## 5.3
### 5.3.1 数据通路-单总线结构

数据通路通常指指令执行过程中数据经过的路径以及路径上的部件。
数据通路=电路+部件（组合+时序），并且由控制信号进行控制。
组合逻辑元件（操作元件）：不能存储，如多路选择器MUX、ALU、译码器。
时序逻辑元件（状态元件）：能存储，如寄存器。

**数据通路-CPU内部单总线方式**
以下内容结合1.2.2“计算机的工作过程”进行学习
![在这里插入图片描述](https://img-blog.csdnimg.cn/11595a8b265f4415a722aa61814a6976.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f43e6a65326e487085314b5bc13abd28.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/6be6fab065214e0ea9b8f1700429ccba.png)
每个时钟周期内，CU都会发出一组相应的控制信号，来完成某一个微操作，到下一个时钟周期，CU又会发出第二个控制信号，完成第二个微操作。

**CPU内部总线方式-例题**

(R0)目的操作数，有括号需要进行一次间接寻址，表示R0中存放的是操作数在主存中的存储地址。
R1源操作数，没有括号表示操作数直接存放在R1寄存器中。
![在这里插入图片描述](https://img-blog.csdnimg.cn/5252258df97c436db5c9f1c9054924a5.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b4911294466c4d17a447e1c8ea5e26ff.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/2d330eaf1df44e48815bb7e5564136f9.png)
### 5.3.2 数据通路-专用通路结构
**专用数据通路方式-取值周期**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c1aca4e1e8da4fde880d2cf5325595e2.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/65b431854d5a4fd49d45365dcb3cdac7.png)
采用CPU内部总线：结构简单，实现容易，性能较低，存在较多的冲突现象。
专用数据通路：结构复杂，硬件量大，不易实现，性能高，基本不存在数据冲突现象。

数据总线是双向的：CPU-->内存，内存-->CPU
地址总线是单向的：CPU-->内存
## 5.4
### 5.4.1硬布线控制器的设计
![在这里插入图片描述](https://img-blog.csdnimg.cn/f5fbe79b96b5481f9f875360a26cb849.png)
CU发出一个微命令，可完成对应微操作。如：微命令 1使得PCout、MARin有效。完成对应的微操作1（PC）->MAR

根据指令操作码、目前的机器周期、节拍信号（T0、T1、T2）、机器状态条件（如PSW中溢出、正负性等）、即可确定现在这个节拍下应该发出哪些微命令。

**1 硬布线控制器**
![在这里插入图片描述](https://img-blog.csdnimg.cn/010b1917f9aa48f8b3592b45f5a5f969.png)
**2 硬布线控制器的设计**（不考，便于理解）
![在这里插入图片描述](https://img-blog.csdnimg.cn/959dd7654b194d3598b9fdb4356747b4.png)
**分析每个阶段的微操作序列**
![在这里插入图片描述](https://img-blog.csdnimg.cn/152a3ba4d1ef40d582d7fc982b480e25.png)
**安排微操作时序的原则-取值周期**

![在这里插入图片描述](https://img-blog.csdnimg.cn/fd719054b13a43b0890dc86f549e83fa.png)
**安排微操作时序的原则-间值周期**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b7d5397ee17d40dba51f3f1d27f22af2.png)
**安排微操作时序的原则-执行周期**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7a42698a49db465b97b5edacd22d8d67.png)
**电路设计-组合逻辑设计**
![在这里插入图片描述](https://img-blog.csdnimg.cn/de42753c1cea4226936ca14145077607.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/964611745d7d47c78106a6cce68c4e99.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/016e6f7bbcd541e4b3a25112aae1930c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e4a4e55b182442bdba6043678c3e33f4.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f95aa32993fe42a48a5ea12f6d29e26f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/59c54063924b40798177fd31f5c4d30f.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/4b3c9e31a1f04a9ca31417d3a7c4745d.png)
### 5.4.2 微程序控制器的基本原理
采用“存储程序”的思想，CPU出厂前将所有指令的“微程序”存入“控制器存储器”中。

![在这里插入图片描述](https://img-blog.csdnimg.cn/e661457bc7c3429789273327756ccf5c.png)

**微程序控制器的基本结构**
![在这里插入图片描述](https://img-blog.csdnimg.cn/58a52d84c1a543bbbee73aa1686bda21.png)

**微程序控制器的工作原理**
![在这里插入图片描述](https://img-blog.csdnimg.cn/6e8f4eedc03e4385bffbc895b9a541fb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/cfb5404e8c6b4ebb992713292edc4b23.png)

**小结**
![在这里插入图片描述](https://img-blog.csdnimg.cn/280ff322004847f39f8b5b7c99649642.png)

### 5.4.3 微指令的设计

微命令与微操作一一对应，一个微命令对应一根输出线
有的微命令可以并行执行，因此一条微指令可以包含多个微命令

相容性微命令：可以并行完成的微命令。
互斥性微命令：不允许并行完成的微命令。

![在这里插入图片描述](https://img-blog.csdnimg.cn/839d6c8e3c7040059213107e16bf5d4b.png)
**微指令的编码方式**

![在这里插入图片描述](https://img-blog.csdnimg.cn/71f986c5ac954562a99adbad27d18bdb.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/732c13ab865b4201baad2aec3eae6d30.png)
字段直接编码方式：

 - 优点：可以缩短微指令字长
 - 缺点：要通过移码电路后再发出微命令，因此比直接编码方式慢。

![在这里插入图片描述](https://img-blog.csdnimg.cn/01f63bc38f7f4ad0a9fc4633687abfb8.png)
**微指令的地址形成方式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d9c4e32684254df494ddf31b48cbea8c.png)
**例题-断定方式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/d36a2af73b1d469f9018abcc5daac036.png)
**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/83f241291f374be0bc8d1a5c6ebcc250.png)
### 5.4.4 微程序控制单元的设计
![在这里插入图片描述](https://img-blog.csdnimg.cn/9b16e2bf22ca4f88ac039c167f21770f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4203887b2edf47de8c13f1ade34a63e1.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/40e9088f7f474135adac7a3dcdc91201.png)
**微程序设计的分类**

 1. 静态微程序设计和动态微程序设计
      静态：微程序无需改变，采用ROM
      动态：通过改变微指令和微程序改变机器指令，有利于仿真，采用EPROM
 2. 豪微程序设计
     豪微程序设计的基本概念
     微程序设计用微程序解释机器指令
     豪微程序设计用豪微程序解释微程序
 
  **硬布线与微程序的比较**
  
![在这里插入图片描述](https://img-blog.csdnimg.cn/173914ffcdce49f784a1dab5790c5515.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a01b105674eb416787371cc4a63857c6.jpeg)

**微程序控制器回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c650111e555446cb96248de08555e9c0.png)
## 5.5异常与中断

举个例子，你在图书馆复习408，在做某道题，你就是CPU（也就是CPU在执行当前指令）。
1.陷入：你想起来昨天晚上的那局王者被单杀，气不过，然后来了一把（你是学习态，想做游戏态的事情，是不是很像系统调用），打完又灰溜溜做题（返回下一条指令）。
2.故障：你突然发现这道题的知识点不会（也就是不在你的内存中），你就去翻书（外存），查到之后还要继续做这道题（返回本条指令）。
3.终止：你突然很累，大脑宕机，不想学习，直接回寝室睡大觉，不回来做题，这就是终止（不可恢复）。
4.外中断：和你自己没关系，旁边来了个妹妹，打断了你的学习，你看了十分钟又灰溜溜的做题，这就是外中断，和你自己（CPU）没关系。

![在这里插入图片描述](https://img-blog.csdnimg.cn/283d042865c243f8839afb82e549ef27.jpeg)

![在这里插入图片描述](https://img-blog.csdnimg.cn/7f90d9e84dfb4326a37c85f4f58757f2.jpeg)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d64054eb5c254cba9e4a344bcf5a96af.jpeg)
## 5.6
### 5.6.1 指令流水线的基本概念

**指令流水线的定义**

一条指令的执行过程可以分成多个阶段（或过程）。根据计算机的不同，具体的分法也不同。
取指：根据PC内容访问主存储器，取出一条指令送到IR中。
分析：对指令操作码进行译码，按照给定的寻址方式和地址字段中的内容形成操作数的有效地址EA，并从有效地址EA中取出操作数。
执行：根据操作码字段，完成指令规定的功能，即把运算结果写到通用寄存器或主存中。

设取指、分析、执行3个阶段的时间都相等，用t表示，按以下几种执行方式分析n条指令的执行时间：
![在这里插入图片描述](https://img-blog.csdnimg.cn/e1575eecda014e9d8e09d35f3f206935.png)
**指令流水线的表示方式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/7526951a6afd4625b4fe64ffb9cbc172.png)
**流水线的性能指标**
![在这里插入图片描述](https://img-blog.csdnimg.cn/5406f5fa01f943a585bca8db3a2699ef.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/0e147f6d69394d76aada8c0a1ecba648.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/017e0e2863bd4ea88e249813afa38ee3.png)
### 5.6.2 指令流水线的影响因素和分类
**机器周期的设置**

IF：取指阶段；
ID：指令译码阶段（指令译码，从通用寄存器中取出当前指令所需要的操作数），imm立即数；
EX：执行阶段；
M：访存阶段；
WB：写回通用寄存器组
cache：data cache和insrtuction cache，将数据和指令放在两个独立的模块中，对这两个模块的访问可以并行进行。
![在这里插入图片描述](https://img-blog.csdnimg.cn/9b6f2e51d2c04acb9bb3c7c59792749c.png)

**影响流水线的因素**

 1. 结构相关（资源冲突--”互斥“）
 2. 数据相关（数据冲突-”同步“）
 3. 控制相关（控制冲突）
 ![在这里插入图片描述](https://img-blog.csdnimg.cn/11796c81cce446b18f7d46e6283e2ac8.png)

 
①结构相关
![在这里插入图片描述](https://img-blog.csdnimg.cn/e62690c5d14a4e8f86f6854c827469f4.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/0661892a72fe43528f375f520270bba4.png)
②数据相关
![在这里插入图片描述](https://img-blog.csdnimg.cn/a5bb999396314a5a9302706dbb35e61d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b8adc5839c2540f4a36917c789c2ce38.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4dd875aa36a24e1a8217c90d96ed105c.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b4b45f5f9ace49c3a03698a9cf8b217b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f24dbb3a19b5412398bff3e8c2e08c12.png)
如果有后续的指令可以提前执行，不需要依赖前序指令的执行结果，可以通过编译器调整指令顺序来解决数据相关。（类似于插入空操作）

③控制相关
![在这里插入图片描述](https://img-blog.csdnimg.cn/20f5a7dff5884706af6e971a2057bece.png)
**流水线的分类**
①部件功能级、处理机级和处理机间级流水线

 - 根据流水线使用的级别的不同，流水线可分为部件功能级流水线、处理机级流水线和处理机间流水线。
 - 部件功能级流水就是将复杂的算术逻辑运算组成流水线工作方式。例如，可将浮点加法操作分成求阶差、对阶、尾数相加以及结果规格化等4个子过程。
 - 处理机级流水是把一条指令解释过程分成多个子过程，如前面提到的取指、译码、执行、访存及写回5个子过程。
 - 处理机间流水是一种宏流水，其中每一个处理机完成某一专门任务，各个处理机所得到的结果需存放在与下一个处理机所共享的存储器中。

②单功能流水线和多功能流水线

 - 按流水线可以完成的功能，流水线可分为单功能流水线和多功能流水线。
 - 单功能流水线指只能实现一种固定的专门功能的流水线;
 - 多功能流水线指通过各段间的不同连接方式可以同时或不同时地实现多种功能的流永线。
 
 ③动态流水线和静态流水线
 - 按同一时间内各段之间的连接方式，流水线可分为静态流水线和动态流水线。
 - 静态流水线指在同一时间内，流水线的各段只能按同一种功能的连接方式工作。
 - 动态流水线指在同一时间内，当某些段正在实现某种运算时，另一些段却正在进行另一种运算。这样对提高流水线的效率很有好处，但会使流水线控制变得很复杂。

④线性流水线和非线性流水线

 - 按流水线的各个功能段之间是否有反馈信号，流水线可分为线性流水线与非线性流水线。
 - 线性流水线中，从输入到输出，每个功能段只允许经过一次，不存在反馈回路。
 - 非线性流水线存在反馈回路，从输入到输出过程中，某些功能段将数次通过流水线，这种流水线适合进行线性递归的运算。

**流水线的多发技术**

![在这里插入图片描述](https://img-blog.csdnimg.cn/23c8e21a42bc496fa858c1a53f98102d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/732c97f40ea84bba9e82d3e0a79b8b9e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f4520186b1b24a1cb535fadf35e65888.png)
**本节回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/fffbd9bee91a4fea8d3afe80bd2b5f7b.png)
### 5.6.3 五段式指令流水线

常见的5类指令：运算类指令、LOAD指令、STORE指令、条件转移指令、五条件转移指令
 
 **运算类指令的执行过程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b74893f26cbc4dfe83e6220cf18919e8.png)
**LOAD指令的执行过程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b2a2cbcc497b4c2aabec7b333acc5b1a.png)
**STORE指令的执行过程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/96df672656204dbbbe448f3d100457cf.png)
**条件转移指令的执行过程**

![在这里插入图片描述](https://img-blog.csdnimg.cn/6e45f971039449d485e7bce5779a15b5.png)
**无条件转移指令的执行过程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c524e652eb42446296756dfa35d2d8fb.png)
## 5.7
Tips：只考选择题
### 5.7.1 多处理器的基本概念
不太严谨的图，方便理解
![在这里插入图片描述](https://img-blog.csdnimg.cn/cfa2a5c97b3e4c0193a60cd09b9e74e0.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b9c0ab6cd6de47b68c50dc52c2e5584b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/4cd93e760f1a4438ae662527deeebd3e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/079cdd544cd1490998797e68b12c7192.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ff0f81fcf2f64a629a67245d554ad0e5.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/d0dc188eadb54813bbeebbfe90abfbde.png)
单指令流单数据流SISD结构：一个指令流对应一个数据流
单指令流多数据流SIMD结构：一个指令流对应多个数据流
多指令流单数据流MISD结构：多个指令流对应一个数据流（事实上不存在)
多指令流多数据流MIMD结构：多个指令流对应多个数据流
M:Multiple
S:Single
l:Instruction
D:Data

![在这里插入图片描述](https://img-blog.csdnimg.cn/1d890332c44240df9966f716693e2662.jpeg)
UMA：统一存储访问
NUMA：非统一存储访问
### 5.7.2 硬件多线程的基本概念

![在这里插入图片描述](https://img-blog.csdnimg.cn/750ed5a124eb4292bcc853fd3c6908e1.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/c09a189c4cec4e008610c73d7c4725e6.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/b5ba3b3d16cf4e14b4d3f9c173973395.png)
# 六、总线
## 6.1
![在这里插入图片描述](https://img-blog.csdnimg.cn/2590747585ba4b20a54729f21f61a77f.png)

**总线简图**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c6e46cf3fa52428389d99411686f7bc6.png)
**总线的物理实现**
![在这里插入图片描述](https://img-blog.csdnimg.cn/3f5d644ec10348dcb79694e3b1edc309.png)

### 6.1.1 总线概述

为什么要用总线？
早期计算机外部设备少时大多采用分散连接方式，不易实现随时增减外部设备。
为了更好的解决I/O设备和主机之间连接的灵活性问题，计算机的结构从分散连接发展为总线连接。

![在这里插入图片描述](https://img-blog.csdnimg.cn/9d7221d350774a5b8217b69060d5d2c1.png)

总线的特性
1.机械特性:尺寸、形状、管脚数、排列顺序
2.电气特性:传输方向和有效的电平范围
3.功能特性:每根传输线的功能(地址、数据、控制)
4.时间特性:信号的时序关系

![在这里插入图片描述](https://img-blog.csdnimg.cn/2b512db98fba44f987ac3320c35be11d.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/b377534a38c344b8909965fb604e17d6.png)
**总线的分类（按总线功能）**

 数据通路表示的是数据流经的路径
 数据总线是承载的媒介

①片内总线
片内总线是芯片内部的总线。
它是CPU芯片内部寄存器与寄存器之间、寄存器与ALU之间的公共连接线。

②系统总线
系统总线是计算机系统内各功能部件。（CPU、主存、I/O接口）之间相互连接的总线。
按数据总线传输信息内容的不同，又可分为三类：数据总线、地址总线和控制总线。
![在这里插入图片描述](https://img-blog.csdnimg.cn/0fec37bbfbcf49d99f08aa28884dc50e.png)
**③通信总线**
通信总线是用于计算机系统之间或计算机系统与其他系统（如远程通信设备、测试设备）之间信息传送的总线，通信总线也称为外部总线。
![在这里插入图片描述](https://img-blog.csdnimg.cn/f05bd1f1a2a044c883628da42897105e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e62358a3fa58428f94a56c476da35cc4.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e8da671c473c419c9d1092678cfe60d0.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ee0f7128f6b54dc59e63e96cffd1f64f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/496ebcb21ca44bc8bffdf4a772cca353.png)
### 6.1.2 总线的性能指标

![在这里插入图片描述](https://img-blog.csdnimg.cn/d9b674e3da0843498d4af303490d36f8.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/44b34c1751c4415891dc1e946923b494.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9de28af8184e418581b84e97259964df.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/ed8d1aab393e493298d9b9b77afc95a7.png)
**总线标准**
![在这里插入图片描述](https://img-blog.csdnimg.cn/551efae40c994a39bf79f74147641862.jpeg)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a945f115363c467aabcf60eb44826cb4.jpeg)
USB总线：
即插即用、热拔插（带电拔插）、菊花链形式连接众多外设
可扩充性好，一个USB控制器可连接127个外部USB设备
可以为低电压设备供电（5V）
高速传输，最新标准可达1280MB/s

多总线结构：
![在这里插入图片描述](https://img-blog.csdnimg.cn/d6fa87b816d140c5b53837cce7a196bc.jpeg)

## 6.3 总线操作和定时
**总线传输的四个阶段**

 1. 申请分配阶段:由需要使用总线的主模块(或主设备)提出申请，经总线仲裁机构决定将下一传输周期的总线使用权授予某一申请者。 也可将此阶段细分为传输请求和总线仲裁两个阶段。
 2. 寻址阶段:获得使用权的主模块通过总线发出本次要访问的从模块的地址及有关命令，启动参与本次传输的从模块。
 3. 传输阶段:主模块和从模块进行数据交换，可单向或双向进行数据传送。
 4. 结束阶段:主模块的有关信息均从系统总线上撤除，让出总线使用权。

总线定时是指总线在双方交换数据的过程中需要时间上配合关系的控制，这种控制称为总线定时，它的实质是一种协议或规则。
![在这里插入图片描述](https://img-blog.csdnimg.cn/fdd9cb89536d499db2f7e7ed406e3d0d.png)
**同步定时方式-读命令**
![在这里插入图片描述](https://img-blog.csdnimg.cn/a3085c7039584bf9ae3156de8464d58a.png)

同步定时方式是指系统采用一个统一的时钟信号来协调发送和接收双方的传送定时关系。

若干个时钟产生相等的时间间隔，每个间隔构成一个总线周期。

在一个总线周期中，发送方和接收方可进行一次数据传送。

因为采用统一的时钟，每个部件或设备发送或接收信息都在固定的总线传送周期中，一个总线的传送周期结束，下一个总线传送周期开始。

优点:传送速度快，具有较高的传输速率;总线控制逻辑简单。
缺点:主从设备属于强制性同步;不能及时进行数据通信的有效性检验，可靠性较差。

同步通信适用于总线长度较短及总线所接部件的存取时间比较接近的系统。

**异步定时方式**

在异步定时方式中，没有统一的时钟，也没有固定的时间间隔，完全依靠传送双
方相互制约的“握手”信号来实现定时控制。
主设备提出交换信息的“请求”信号，经接口传送到从设备;从设备接到主设备的请求后，通过接口向主设备发出“回答”信号。
根据“请求”和“回答”信号的撤销是否互锁，分为以下3种类型。

 - 不互锁方式
 - 半互锁方式
 - 全反锁方式

优点：总线周期长度可变，能保证两个工作速度相差很大的部件或者设备之间可靠地进行信息交换，自动适应时间的配合。
缺点：比同步控制方式稍复杂一些，速度比同步定时方式慢。
![在这里插入图片描述](https://img-blog.csdnimg.cn/590a207d9c924b62916c6ca527fbb29f.png)
**半同步通信**
![在这里插入图片描述](https://img-blog.csdnimg.cn/b40fa04736ef4de9b5acb95fc734c3a1.png)

**分离式通信**
![在这里插入图片描述](https://img-blog.csdnimg.cn/4969dcfbc3c34934aebbfb9246e61337.png)

**本节回顾**

![在这里插入图片描述](https://img-blog.csdnimg.cn/d7812f6cca194d61b084b3f9aa968849.png)
# 七、输入输出系统
![在这里插入图片描述](https://img-blog.csdnimg.cn/0781742b8fdd4441a3b30cf4c66e4e0d.png)
## 7.1 输入输出系统及I/O控制方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/95b1484127f54b4b8ef2e6f14a03c8c4.png)

I/O接口：又称I/O控制器、设备控制器、负责协调主机与外部设备之间的数据传输。（I/O控制器就是一块芯片，常被集成在主板上）

**I/O控制方式简介**
![在这里插入图片描述](https://img-blog.csdnimg.cn/61663e8036e74a68ad94f8094868ef56.png)

**DMA控制方式**
![在这里插入图片描述](https://img-blog.csdnimg.cn/92519f2439a94ff082e21aa48088f053.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/efbe763a3a2d4890a5a7980d1aaab4d5.png)
**通道控制方式**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a1df5448a3184dbea88f5b27c4711ce5.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b4224becebde42d1821ec8b048e15194.png)
**I/O系统基本组成**

![在这里插入图片描述](https://img-blog.csdnimg.cn/1ada4dee026946408d9a92a84489764d.png)
**本节回顾**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a367cfbde468457fb9099d8a5aca09b4.png)

## 7.2 I/O接口
![在这里插入图片描述](https://img-blog.csdnimg.cn/389378c679e74592b3166045bacf333d.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/fdccfb2139b14e72bd3b47d8ed73f1c9.png)

**I/O接口的工作原理**

![在这里插入图片描述](https://img-blog.csdnimg.cn/a93664144b7541f488fe12ec0749fcd2.png)

**接口与端口**
![在这里插入图片描述](https://img-blog.csdnimg.cn/e24a5d0662124d198c505143f09b9f98.png)

**统一编址 V.S. 独立编址**

![在这里插入图片描述](https://img-blog.csdnimg.cn/fe0df8e79a7f47129c934a02d5f2b25a.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/b258f29f039d427799608274cdbdbd84.png)

**I/O接口的类型**

![在这里插入图片描述](https://img-blog.csdnimg.cn/21207eac24984232a2cbaa0a05999f1b.png)

**知识回顾**
![在这里插入图片描述](https://img-blog.csdnimg.cn/5b1fae32987b4338b71d63a1d11f8416.png)
## 7.3
### 7.3.1 程序查询方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/70f97c8f9c7d4cecb3e65c878e35f7ab.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/a2dc1f8713404af4881481ac63626296.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/62c2801778744a1ab6a7c6aa28004661.png)


独占查询：CPU100%的时间都在查询I/O状态，完全串行。
定时查询：在保证数据不丢失的情况下，每隔一段时间CPU就查询一次I/O状态。查询的间隔内CPU可以执行其他程序。

### 7.3.2 中断的作用和原理
**中断的基本概念**

![在这里插入图片描述](https://img-blog.csdnimg.cn/bb2347688e924c7e94e72f92823d97cb.png)

**中断请求的分类**

![在这里插入图片描述](https://img-blog.csdnimg.cn/b45eed9401a84d6e87045bd1905d9ff3.png)

**中断请求标记**
![在这里插入图片描述](https://img-blog.csdnimg.cn/9a8b33c4fa704985a30d46b724ad4eb0.png)

**中断判优实现**
![在这里插入图片描述](https://img-blog.csdnimg.cn/646d3e7201a44631bfc09a5b3905d34f.png)

**中断判优-优先级设置**

 1. 硬件故障中断属于最高级，其次是软件中断
 2. 非屏蔽中断优于可屏蔽中断
 3. DMA请求优于I/0设备传送的中断请求
 4. 高速设备优于低速设备
 5. 输入设备优于输出设备
 6. 实时设备优于普通设备

**中断处理过程**
![在这里插入图片描述](https://img-blog.csdnimg.cn/c5ea5c6be8064c308c721f37fe669bf7.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/d4a22c80bce048968a589d0ad9fe67e1.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/ecf7e82e555a4fe58b44f0feae958b4d.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/2b607bd5e62749dea3af64cdb521cbcc.png)

### 7.3.3 多重中断

![在这里插入图片描述](https://img-blog.csdnimg.cn/be3debf461174f009192f7978766b033.png)


**中断屏蔽技术**
![在这里插入图片描述](https://img-blog.csdnimg.cn/2f8aa044e8464722b750b1ad6c03108e.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/7639e470d71847de8abe4e8b3054ef0e.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/8637c78011f64f11a5166cb8379fa635.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/d13c0b9b3ece4fa2888db3cc4d75f953.png)
### 7.3.4 程序中断方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/07e7ec3f82324a0c9e73d1e228de1505.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/65fcebb79602418592d056cf71f8e99f.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9023f32eb6f147fc9a8952030e038b2e.png)

### 7.3.5 DMA方式
![在这里插入图片描述](https://img-blog.csdnimg.cn/46946934da5243d48975af2b06fe3f07.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/71344bdac3954c488d896421e5db6bd9.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/e0d8015b073542d7977e07a4c8839f2b.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/d61928e5a1be4b2eacde75e5f0f952ae.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/f59df8641c814cd2836a277bd4e8823b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/664e5db45afb44d0a0ba656df13b3768.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/95cf610117524411b371ef8c1dea5d7b.png)
![在这里插入图片描述](https://img-blog.csdnimg.cn/9db43fc341634ddf87724733d50c45f7.png)

![在这里插入图片描述](https://img-blog.csdnimg.cn/82005affbe42484dad7fce86141f0dc4.jpeg)

















